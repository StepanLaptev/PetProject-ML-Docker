# Описание проекта
*Проект сделан на основе соревнований: https://zindi.africa/competitions/ai4d-lab-tanzania-tourism-classification-challenge/data

Набор данных описывает актуальную информацию о туристических расходах, собранных 
        Национальным бюро статистики (НБС) Танзании. Набор данных был собран, чтобы лучше понять состояние сектора 
        туризма и предоставить инструмент, который будет обеспечить рост отрасли.
        Необходимо классифицировать диапазон расходов, которые турист (тур.группа) тратит в Танзании. 
        Модель может использоваться различными туроператорами и Советом по туризму Танзании, 
        чтобы автоматически помочь туристам со всего мира оценить свои расходы перед посещением Танзании. 

**Target:** классификация расходов туристических групп предполагает 6 категорий: ***Highest Cost***, ***Higher Cost***, 
***High Cost***, ***Normal Cost***, ***Low Cost***, ***Lower Cost***. 

Показателем оценки для этой задачи является **logloss**
# Демо версия сервиса
![](demo/demo_project.gif)
# Признаки
- Tour_ID - Unique identifier for each tourist (Уникальный идентификатор для каждого туриста)
- country - Страна, из которой приехал турист
- age_group - Возрастная группа туриста
- travel_with - Отношение людей, с которыми путешествуют туристы по Танзании
- total_female - количество женщин в одной группе
- total_male - количество мужчин в одной группе
- purpose - Цель посещения Танзании
- main_activity - Основное направление туризма в Танзании
- info_source - Источник информации о туризме в Танзании
- tour_arrangment - Организация посещения Танзании
- package_transport_int - Если турпакет включает международные перевозки
- package_accomodation - Если в турпакет входит услуга проживания
- package_food - Если в турпакет включено питание
- package_transport_tz - Если турпакет включает транспортное обслуживание в пределах Танзании
- package_sightseeing - Если турпакет включает экскурсионное обслуживание
- package_guided_tour - Если турпакет включает гида
- package_insurance - если турпакет включает страховку
- night_mainland - Количество ночей, проведенных туристом на материковой части Танзании
- night_zanzibar - Количество ночей, проведенных туристом на Занзибаре *Занзибар - остров
- first_trip_tz - Если бы это была первая поездка в Танзанию)
- cost_category - Диапазон расходов, которые турист тратит в Танзании

# Обучение модели
Задача относится к многоклассовой классификации. Имеется дисбаланс классов. Для обучения модели было необходимо
предвариельно обработать данные: заполнить пропуски, исправить орфографические ошибки, убрать пробелы и знаки 
пунктуации из значений признаков.
* используются алгоритм **LGBM**, т.к. хорошо справляется с категориальными данными и 
подходит для многоклассовой классификации (был предварительно выбран из перечня моделей, обученных на данном датасете,
показателем оценки была метрика - logloss)
* подбор наилучших параметров модели осуществляется с помощью **optuna**

# Структура проекта
* /backend - Папка с проектом FastAPI (обучение модели, предсказания классов)
* /frontend - Папка с проектом Streamlit
* /config - Папка, содержащая конфигурационный файл
* /data - Папка, содержащая исходные данные, обработанные данные, уникальные значения в формате json, 
а также неразмеченный файл для подачи на вход модели
* /demo - Папка, содержащая демо работы сервиса в Streamlit UI в формате gif
* /models - Папка, содержащая сохраненную модель после тренировки, а также объект study (optuna)
* /notebooks - Папка, содержащая jupyter ноутбуки с предварительным анализом данных
* /report - Папка, содержащая информацию о лучших параметрах и метриках после обучения 

# Структура сервиса
- **Основная страница:** описание проекта и признаков датасета
- **EDA:** вывод датасета и графиков распределения признаков 
- **Train:** обучение модели
- **Prediction:** предсказание классов на тестовом датасете (загрузка файла)
- **Prediction input** предсказание на вводимых пользователем значениях сервиса (UI)

# Инструкция 
В проекте используются сервесы: FastAPI и Streamlit. Они объединяются в один сервис с помощью Docker

Проект запускается через команду:

docker compose up -d